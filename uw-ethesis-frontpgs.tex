% T I T L E   P A G E
% -------------------
% Last updated August 24, 2023, by IST-Client Services
% The title page is counted as page `i' but we need to suppress the
% page number. Also, we don't want any headers or footers.
\pagestyle{empty}
\pagenumbering{roman}

% The contents of the title page are specified in the "titlepage"
% environment.
\begin{titlepage}
        \begin{center}
        \vspace*{1.0cm}

        \Huge
        {\bf Accelerating Post-Quantum Secure zkSNARKs for Privacy-Preserving Frameworks}

        %Privacy Preserving Framework Design and Acceleration of Post-Quantum zkSNARKs

        \vspace*{1.0cm}

        \normalsize
        by \\

        \vspace*{1.0cm}

        \Large
        Mohammadtaghi Badakhshan \\

        \vspace*{2.5cm}

        \normalsize
        A thesis \\
        presented to the University of Waterloo \\ 
        in fulfillment of the \\
        thesis requirement for the degree of \\
        Doctor of Philosophy \\
        in \\
        Electrical and Computer Engineering \\

        \vspace*{2cm}

        Waterloo, Ontario, Canada, 2025 \\

        \vspace*{1.5cm}

        \copyright\ Mohammadtaghi Badakhshan 2025 \\
        \end{center}
\end{titlepage}

% The rest of the front pages should contain no headers and be numbered using Roman numerals starting with `ii'
\pagestyle{plain}
\setcounter{page}{2}

\cleardoublepage % Ends the current page and causes all figures and tables that have so far appeared in the input to be printed.
% In a two-sided printing style, it also makes the next page a right-hand (odd-numbered) page, producing a blank page if necessary.
\phantomsection    % allows hyperref to link to the correct page
 
% E X A M I N I N G   C O M M I T T E E (Required for Ph.D. theses only)
% Remove or comment out the lines below to remove this page
\addcontentsline{toc}{chapter}{Examining Committee}
\begin{center}\textbf{Examining Committee Membership}\end{center}
  \noindent
The following served on the Examining Committee for this thesis. The decision of the Examining Committee is by majority vote.
  \bigskip
  
  \noindent
\begin{tabbing}
Internal-External Member: \=  \kill % using longest text to define tab length
External Examiner: \>  Dr. Liqun Chen \\ 
\> Professor, Dept. of Computer Science and Electronic Engineering,\\
\> University of Surrey \\
\end{tabbing} 
  \bigskip
  
  \noindent
\begin{tabbing}
Internal-External Member: \=  \kill % using longest text to define tab length
Supervisor: \> Dr. Guang Gong \\
\> Professor, Dept. of Electrical and Computer Engineering,\\
\> University of Waterloo \\

\end{tabbing}
  \bigskip
  
  \noindent
  \begin{tabbing}
Internal-External Member: \=  \kill % using longest text to define tab length
Internal Member: \> Dr. Anwar Hasan\\
\> Professor, Dept. of Electrical and Computer Engineering,\\
\> University of Waterloo \\
\end{tabbing}
  \bigskip

  \noindent
  \begin{tabbing}
Internal-External Member: \=  \kill % using longest text to define tab length
Internal Member: \>  Dr. Mahesh Tripunitara  \\
\> Professor, Dept. of Electrical and Computer Engineering,\\
\> University of Waterloo \\
\end{tabbing}
  \bigskip

  
  \noindent
\begin{tabbing}
Internal-External Member: \=  \kill % using longest text to define tab length
Internal-External Member: \>  Dr. Douglas Stebila  \\
\> Professor, Dept. of Combinatorics and Optimization,\\ \> University of Waterloo \\
\end{tabbing}
  \bigskip
  

\cleardoublepage
\phantomsection    % allows hyperref to link to the correct page

% D E C L A R A T I O N   P A G E
% -------------------------------
  % The following is a sample Declaration Page as provided by the GSPA
  % December 13th, 2006.  It is designed for an electronic thesis.
 \addcontentsline{toc}{chapter}{Author's Declaration}
 \begin{center}\textbf{Author's Declaration}\end{center}

 % Author's Declaration Option ONE - line 118:  
 \noindent
% This thesis consists of material all of which I authored or co-authored: see Statement of
% Contributions included in the thesis.  %This is a true copy of the thesis, including any required final revisions, as accepted by my examiners.
  % Author's Declaration Option TWO - line 121. Updated August 21st, 2023. Use the following declaration text if appropriate by removing the percent character and space at the beginning of line 121, and add a percent symbol and space at line 118 to change Author's Declaration Option ONE to a remark that is not printed.
 \noindent  
This thesis consists of material all of which I authored or co-authored: see Statement of Contributions included in the thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners.
  \bigskip
  
  \noindent
I understand that my thesis may be made electronically available to the public.

\cleardoublepage
\phantomsection    % allows hyperref to link to the correct page

% STATEMENT OF CONTRIBUTIONS
% ---------------
\addcontentsline{toc}{chapter}{Statement of Contributions}
\begin{center}\textbf{Statement of Contributions}\end{center}
%Mohammadtaghi Badakhshan is the sole author of Chapters~\ref{ch:Intro}, \ref{ch:zupply-design}, and~\ref{ch:conclusion} which were written under the supervision of Professor Guang Gong, but are still under review, or were not written for any publication, or have not yet been edited for future submission.   

This thesis includes work from three peer-reviewed and accepted or published papers, as well as two manuscripts intended for future publication. Below are the titles, authors, and venues of each manuscript, followed by the contributions of the thesis author and the corresponding sections of the thesis that were derived from each manuscript:

\noindent (1) Mohammadtaghi Badakhshan, Susanta Samanta, Guang Gong, ``Accelerating Post-Quantum Secure zkSNARKs through Optimizing Additive FFT,'' \textit{Unpublished}.\ \\
The preliminary material and literature review from this manuscript appear in Chapters~\ref{ch:preliminaries} and~\ref{ch:lit_review}, specifically in the following sections: \ref{sec:prel_finite_field}, \ref{sec:prel_affine_sub_space}, \ref{sec:prel_vanishing}, \ref{sec:vec_rep}, \ref{sec:prel_dft}, \ref{sec:prel_aurora}, and \ref{sec:prel_AFFT} in Chapter~\ref{ch:preliminaries}, and Section~\ref{sec:lit_additive_fft} in Chapter~\ref{ch:lit_review}. These sections have been adapted and extended to fit the context of the thesis.
Additionally, Chapter~\ref{ch:additive-fft} is based on this manuscript. The specific contributions of Mohammadtaghi Badakhshan to this work are detailed at the beginning of that chapter.

\noindent (2) Mohammadtaghi Badakhshan, Guiwen Luo, Tanmayi Jandhyala, Guang Gong, ``Ursa Minor: The Implementation Framework for Polaris,'' \textit{Arithmetic of Finite Fields}, 2025. (Ref. \cite{Badakhshan2025Ursa}).\\
The preliminary material from this paper is reflected in Sections~\ref{gkr},\ref{sec:prel_FRI}, and\ref{sec:prel_polaris} of Chapter~\ref{ch:preliminaries}. Furthermore, Chapter~\ref{ch:polaris} is based on this paper. Mohammadtaghi Badakhshan was responsible for all aspects related to the GKR circuit presented in the paper.

\noindent (3) Mohammadtaghi Badakhshan, Guang Gong, ``Zupply: Anonymously Maintained Decentralized DAG Data Record Over Public Blockchains,'' \textit{TechRxiv}, 2024.(Ref. \cite{Badakhshan2024Zupply}). \\
The preliminary material and literature review from this manuscript are reflected in Sections~\ref{sec:prel_r1cs} and~\ref{sec:prel_Cryptographic Primitives} of Chapter~\ref{ch:preliminaries}, as well as in portions of Sections~\ref{sec:lit_Blockchain_based_preserving_protocols} and \ref{sec:lit_SCM} of Chapter~\ref{ch:lit_review}.
Additionally, Chapter~\ref{ch:zupply-design}, Section~\ref{sec:zupply_primitive_and_parameters}, and the implementation using the Groth16 zkSNARK over the BN254 curve in Chapter~\ref{ch:zupply_implementation} are based on this manuscript. Mohammadtaghi Badakhshan designed and implemented the framework presented in the manuscript and authored it under the supervision of Professor Guang Gong.

\noindent (4) Mohammadtaghi Badakhshan, Guang Gong, ``Privacy-Preserving Ownership Transfer: Challenges and An Outlined Solution Based on Zero-Knowledge Proofs,'' \textit{IEEE 9th World Forum on Internet of Things}. 2023. (Ref. \cite{Badakhshan2023Outline}).\\
Portions of Sections~\ref{sec:lit_Blockchain_based_preserving_protocols} and \ref{sec:lit_SCM} in Chapter~\ref{ch:lit_review} are derived from this paper. Mohammadtaghi Badakhshan authored the paper under the supervision of Professor Guang Gong.

\noindent (5) Mohammadtaghi Badakhshan, Guang Gong, ``Evaluating the Integration of {Aurora} {zkSNARK} in the {Zupply} Framework,'' \textit{IEEE/ACM 6th International Workshop on Engineering and Cybersecurity of Critical Systems (EnCyCriS)}. 2025. (Ref. \cite{Badakhshan2025AuroraZupply}).\\
Section~\ref{sec:Zupply Arithmetic Circuits}, as well as the implementation of the Zupply framework using Groth16 over BLS12-381 and using the Aurora zkSNARK, along with the comparative analysis presented in Chapter~\ref{ch:zupply_implementation}, are derived from this paper. Mohammadtaghi Badakhshan carried out the design, implementation, and authorship of the paper under the supervision of Professor Guang Gong.

%Chapters~\ref{ch:Intro}, \ref{ch:lit_review}, \ref{ch:additive-fft}, \ref{ch:polaris}, \ref{ch:zupply-design}, \ref{ch:zupply_implementation} include material from published papers \cite{Badakhshan2023Outline,Badakhshan2025AuroraZupply,Badakhshan2025Ursa} and two unpublished papers \cite{Badakhshan2024Zupply} and a paper on a
%
%I authored with my supervisor, Professor Gong or co-authored with more than two authors. Specific contributions and collaborations are clearly indicated at the beginning of each chapter.
\cleardoublepage
\phantomsection    % allows hyperref to link to the correct page
% A B S T R A C T
% ---------------
\addcontentsline{toc}{chapter}{Abstract}
\begin{center}\textbf{Abstract}\end{center}

Zero-knowledge succinct non-interactive arguments of knowledge (zkSNARKs) are gaining widespread adoption across various applications. Despite significant progress in developing post-quantum secure zkSNARKs, current schemes still encounter notable challenges, particularly regarding computational complexity.
This thesis proposes utilizing the Cantor special basis (Cantor, 1989) to enhance post-quantum secure zkSNARKs operating over binary extension fields. By adopting this basis, the additive fast Fourier transform (FFT) algorithm employed in Aurora (Ben-Sasson et al., 2019), a plausible post-quantum secure zkSNARK, is optimized by replacing the previously utilized Gao-Mateer FFT (Gao and Mateer, 2010) with the more efficient Cantor FFT  (Cantor, 1989). The implementation demonstrates substantial reductions in computation time for Aurora, indicating potential performance improvements for other zkSNARK systems reliant on additive FFTs. A thorough theoretical analysis of the computational complexity of the Cantor FFT algorithm is provided, including precise counts of required additions, multiplications, and precomputation overhead. Additionally, the FFT call complexity within the rank-1 constraint system (R1CS) encoding is examined for Aurora.
Furthermore, this thesis includes an extensive analysis of the algorithms within Polaris (Fu and Gong, 2022), a plausible post-quantum zkSNARK protocol, by systematically decomposing its components for detailed evaluation. To address the critical need for efficient real-world implementations, a concrete GKR (Goldwasser et al., 2008) arithmetic circuit is proposed for integration into Polaris. Additionally, the efficiency of the FRI protocol (Ben-Sasson et al., 2018) within Polaris is enhanced by eliminating costly field inversion operations.

Finally, as an illustrative example of a privacy-preserving protocol utilizing zkSNARKs, a novel Anonymous Authentication Token (AAT) scheme is proposed. This scheme supports the unlinkable transfer of token ownership (AAT Ownership Transfer or AATOT), including the merging and dividing of tokens in an unlinkable manner. The construction leverages zkSNARK protocols to ensure anonymity, unlinkability, and authentication. Building upon this foundation, the Zupply framework is introduced, a decentralized system designed to maintain directed acyclic graphs (DAGs) of authentic data records. Zupply operates atop a permissionless blockchain equipped with smart contracts, offering a trustless environment that preserves participant anonymity and unlinkability. At the same time, the integrity and authenticity of data records are ensured across the entire supply chain ecosystem. Optimized arithmetic circuits are designed and implemented within the Zupply framework to minimize proof sizes and verification costs. Post-quantum secure solutions are concurrently explored to future-proof the framework against quantum computing advancements. The implementation of Zupply is carried out in C++ and Solidity, utilizing two distinct zkSNARK protocols: Groth16 (Groth, 2016) and Aurora. The Groth16 zkSNARK, while vulnerable to quantum attacks, provides computational efficiency and reduced operational costs, thereby demonstrating Zupply’s practicality for real-world decentralized supply chain management (SCM) systems. In contrast, the Aurora zkSNARK is designed to be plausibly secure against quantum-capable adversaries. A comparative analysis of computation efficiency and proof sizes between these two zkSNARK variants is conducted.






\cleardoublepage
\phantomsection    % allows hyperref to link to the correct page

% A C K N O W L E D G E M E N T S
% -------------------------------
\addcontentsline{toc}{chapter}{Acknowledgements}
\begin{center}\textbf{Acknowledgements}\end{center}

I would like to sincerely thank my supervisor, Professor Guang Gong, for her unwavering support and guidance throughout my PhD. Her expertise in cryptography and abstract algebra introduced me to the fascinating world of zero-knowledge proofs, an area I knew very little about before starting this journey. She gave me the freedom to explore my own research directions, while always being there to offer advice and encouragement during difficult times. Her kindness and support went beyond academics and created an environment where I could grow both professionally and personally. It has been an honor to be her student, and I will always be grateful for everything I have learned from her.

I am truly grateful to Professor Liqun Chen, Professor Anwar Hasan, Professor Mahesh Tripunitara, and Professor Douglas Stebila for serving on my thesis committee. Their thoughtful feedback and valuable suggestions helped improve the quality of this work. I deeply appreciate the time and effort they dedicated to reviewing my thesis and supporting my progress.

I would like to thank my parents for their unconditional love, support, and belief in me throughout every step of my life. Their sacrifices and values have shaped who I am today. Even from afar, they have always been with me, giving me strength and reminding me to keep going with honesty and perseverance. I dedicate this achievement to them with love and deep appreciation.

Last but not the least, I am incredibly grateful to my girlfriend, Maryam Mottaghi, for her endless support, patience, and love during this journey. She stood by me through all the ups and downs, encouraged me when I struggled, and believed in me when I needed it most. Her presence has been a source of peace and motivation, and sharing this chapter of life with her has been a true gift.

I also wish to express my sincere gratitude to XRP Ledger, BTQ Corporation, and MITACS for their financial support throughout my PhD studies.

\cleardoublepage
\phantomsection    % allows hyperref to link to the correct page

% D E D I C A T I O N
% -------------------
\addcontentsline{toc}{chapter}{Dedication}
\begin{center}\textbf{Dedication}\end{center}

To my parents.
\cleardoublepage
\phantomsection    % allows hyperref to link to the correct page

% T A B L E   O F   C O N T E N T S
% ---------------------------------
\renewcommand\contentsname{Table of Contents}
\tableofcontents
\cleardoublepage
\phantomsection    % allows hyperref to link to the correct page

% L I S T   O F   F I G U R E S
% -----------------------------
\addcontentsline{toc}{chapter}{List of Figures}
\listoffigures
\cleardoublepage
\phantomsection		% allows hyperref to link to the correct page

% L I S T   O F   T A B L E S
% ---------------------------
\addcontentsline{toc}{chapter}{List of Tables}
\listoftables
\cleardoublepage
\phantomsection		% allows hyperref to link to the correct page

% L I S T   O F   A B B R E V I A T I O N S
% ---------------------------
\renewcommand*{\abbreviationsname}{List of Abbreviations}
\printglossary[type=abbreviations]
\cleardoublepage
\phantomsection		% allows hyperref to link to the correct page

% L I S T   O F   S Y M B O L S
% ---------------------------
\printglossary[type=symbols]
\cleardoublepage
\phantomsection		% allows hyperref to link to the correct page


% Change page numbering back to Arabic numerals
\pagenumbering{arabic}

